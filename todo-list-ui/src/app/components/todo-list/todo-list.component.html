<app-spinner [loading]="loading()"></app-spinner>

<section class="todo-card">
  <h1>Welcome to Mukesh's TODO List</h1>

  <div class="toolbar">
    <mat-form-field class="search" appearance="outline">
      <mat-label>Search todos…</mat-label>
      <input matInput [ngModel]="searchTerm()" (ngModelChange)="searchTerm.set($event)" />
    </mat-form-field>

    <button mat-raised-button type="button" color="primary" (click)="openAddDialog()">
      Add New
    </button>
  </div>

  @if (filteredTodos.length) {
    <div class="list">
      @for (item of filteredTodos; track trackById($index, item)) {
        <div class="row">
          <div class="title">
            {{ item.title }}
          </div>
          <div class="when">
            {{ item.appointment ? (item.appointment | date:'d MMM, y · h:mm a') : 'No date' }}
          </div>
          <div class="actions">
            <button mat-button (click)="openEditDialog(item)">Edit</button>
            <button mat-button color="warn" (click)="confirmDelete(item)">Delete</button>
          </div>
        </div>
      }
    </div>
  }
  @else {
    <p class="empty">No TODOs yet. Add one above.</p>
  }

  @if (error()) {
    <p class="error">{{ error() }}</p>
  }
</section>
